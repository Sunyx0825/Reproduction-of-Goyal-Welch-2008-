# Goyal & Welch (2008) 复现结果与分析

本说明基于项目输出的 `annual_results.csv` 与 `monthly_results.csv`，对照 Goyal & Welch (2008) 的核心表格结论，给出“是否一致”的判断与差异来源的简要分析。

## 1. 复现范围与口径

- **目标**：复现单变量预测回归（equity premium predictability）的主要结论，并给出样本内（IS）与样本外（OOS）表现。
- **输出**：
  - 年度：`output/annual_results.csv`
  - 月度：`output/monthly_results.csv`
- **OOS 设定（代码口径）**：以“起始样本后 20 年”作为样本外预测起点（先用 20 年数据建立初始模型，然后逐期扩展样本做递归预测）。
- **覆盖情况**：只复现了论文中部分表格/变量的核心统计量；未复现论文中的 bootstrap/power、5 年期预测等扩展设定。

## 2. 总体结论（是否一致）

- **方向性结论：基本一致。** 我们的结果支持论文的核心信息：大量经典预测变量在样本外并不能稳定击败“历史均值”基准，样本外 **OOS R² 多为负值**；少数变量可能相对更稳健。
- **数值层面：年度结果与论文的某些口径更接近；月度结果整体接近但存在若干显著偏离（尤其是 `tms`、`infl`、`dfy`）。** 这些偏离更像“变量定义/信息滞后处理/样本区间”口径差异，而不是统计噪声。

## 3. 年度（Annual）结果对照

### 3.1 我们的年度输出摘要

| predictor   |   IS R2(1927起, %) |   IS R2(OOS区间, %) |   OOS R2(%, 20年后起) |   ΔRMSE(%, 正=更好) |   IS R2(1965起, %) |
|:------------|-------------------:|--------------------:|----------------------:|--------------------:|-------------------:|
| b/m         |               4.2  |                0.45 |                -13.48 |               -0.95 |              -2.2  |
| de          |              -1.07 |               -1.47 |                 -4.97 |               -0.29 |              -2.49 |
| dp          |               1.28 |                7.11 |                 -1.35 |               -0.01 |               0.09 |
| dy          |               2.33 |                5.77 |                -16.98 |               -1.21 |               0.16 |
| eqis        |               9.62 |                3.11 |                  1.93 |                0.26 |               3.94 |
| ntis        |               9.73 |               -1.42 |                 -5.54 |               -0.34 |               1.3  |

### 3.2 与原文结论的对应

- 我们的年度样本在实现上**聚焦 1927 年之后**（更接近论文中讨论的“数据从 1927 开始、预测从 20 年后开始”的口径），因此与论文正文中“将数据起点设为 1927、预测从 1947 开始”那部分数字更可比。
- 例如 **`d/y` 的 OOS R²**：我们的结果为 **-16.98%**，与原文讨论的 **约 -16.65%** 非常接近（同向且量级相当）。
- 对大多数变量而言，我们复现的 **OOS R² 为负**，与论文在多张表格中强调的“多数预测变量 OOS 表现不佳”一致。

## 4. 月度（Monthly）结果对照

### 4.1 我们的月度输出（抽样展示）

下表选取了几类代表性变量：股息/估值类（`dp`、`de`、`b/m`、`ntis`），利率/期限结构（`tbl`、`lty`、`ltr`、`tms`），宏观（`infl`、`dfy`）。

| predictor   |   IS R2(对数, %) |   IS R2(简单, %) |   OOS R2(简单, %) |   截断T(%) |   符号约束U(%) |   OOS R2(TU, %) |   ΔRMSE(简单, 正=更好) |
|:------------|-----------------:|-----------------:|------------------:|-----------:|---------------:|----------------:|-----------------------:|
| b/m         |             0.45 |             0.81 |             -3.25 |      44.4  |           0    |           -2.2  |                -0.0434 |
| de          |             0.02 |            -0.1  |             -0.69 |       0    |          12.64 |           -0.65 |                -0.0114 |
| dfy         |            -0.06 |             0.28 |             -0.48 |       3.88 |           0    |           -0.42 |                -0.0066 |
| dp          |             0.12 |             0.33 |             -0.26 |      32.61 |           0    |            0.23 |                 0.007  |
| infl        |            -0    |             0.15 |              0.77 |       1.29 |           0    |            0.81 |                 0.0191 |
| ltr         |             0.04 |             0.07 |             -0.63 |       3.16 |          38.07 |            0.23 |                 0.007  |
| lty         |            -0.03 |             0.02 |             -0.78 |      34.2  |           0    |            0.29 |                 0.0083 |
| ntis        |             0.94 |             1.02 |             -0.1  |       0.43 |           0    |           -0.09 |                 0.0003 |
| tbl         |             0.1  |             0.2  |             -0.05 |      23.13 |           0    |            0.28 |                 0.0082 |
| tms         |             0.06 |             0.17 |              0.09 |       4.17 |           0    |            0.11 |                 0.0045 |

### 4.2 一致性结论

- **较为一致的部分**：如 `de`、`tbl`、`lty`、`ltr` 等变量在 OOS R²、截断频率（T/U）与 ΔRMSE 的数量级上，与论文表格呈现的模式较为接近。
- **明显偏离的部分**：`tms`、`infl`、`dfy` 的 OOS 表现与论文表格存在显著差异（不仅是小数点后四舍五入级别）。

### 4.3 可能的差异来源

1. **样本区间差异**：本项目的月度数据包含到 **2005-12**，而论文表格常用的是 **到 2004-12**。在少数变量上，额外一年可能显著改变 OOS 指标。
2. **递归/滚动窗口口径**：若论文使用与本项目不同的递归（expanding）/滚动（rolling）估计窗口，或对预测变量发布时点做了更严格的可得性约束，会影响 T/U 频率与 OOS R²。


